module.exports=[44970,e=>{"use strict";let t;var r=e.i(58170),i=e.i(71747),n=e.i(91468),a=e.i(16517),s=e.i(49796),o=e.i(16408),l=e.i(98493),d=e.i(38514),u=e.i(7705),p=e.i(45629),c=e.i(29100),g=e.i(22767),h=e.i(97799),f=e.i(64496),m=e.i(32177),v=e.i(58320),x=e.i(93695);e.i(8022);var E=e.i(5515),b=e.i(33406),N=e.i(33780);let T={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(e,t,r){return e},captureMetaData:!1},w=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",y=RegExp("^"+("["+w+"]["+w)+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$");function I(e,t){let r=[],i=t.exec(e);for(;i;){let n=[];n.startIndex=t.lastIndex-i[0].length;let a=i.length;for(let e=0;e<a;e++)n.push(i[e]);r.push(n),i=t.exec(e)}return r}let C=function(e){return null!=y.exec(e)};t="function"!=typeof Symbol?"@@xmlMetadata":Symbol("XML Node Metadata");class S{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,t){"__proto__"===e&&(e="#__proto__"),this.child.push({[e]:t})}addChild(e,r){"__proto__"===e.tagname&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child}),void 0!==r&&(this.child[this.child.length-1][t]={startIndex:r})}static getMetaDataSymbol(){return t}}class A{constructor(e){this.suppressValidationErr=!e}readDocType(e,t){let r={};if("O"===e[t+3]&&"C"===e[t+4]&&"T"===e[t+5]&&"Y"===e[t+6]&&"P"===e[t+7]&&"E"===e[t+8]){t+=9;let i=1,n=!1,a=!1;for(;t<e.length;t++)if("<"!==e[t]||a)if(">"===e[t]){if(a?"-"===e[t-1]&&"-"===e[t-2]&&(a=!1,i--):i--,0===i)break}else"["===e[t]?n=!0:e[t];else{if(n&&_(e,"!ENTITY",t)){let i,n;t+=7,[i,n,t]=this.readEntityExp(e,t+1,this.suppressValidationErr),-1===n.indexOf("&")&&(r[i]={regx:RegExp(`&${i};`,"g"),val:n})}else if(n&&_(e,"!ELEMENT",t)){t+=8;let{index:r}=this.readElementExp(e,t+1);t=r}else if(n&&_(e,"!ATTLIST",t))t+=8;else if(n&&_(e,"!NOTATION",t)){t+=9;let{index:r}=this.readNotationExp(e,t+1,this.suppressValidationErr);t=r}else if(_(e,"!--",t))a=!0;else throw Error("Invalid DOCTYPE");i++}if(0!==i)throw Error("Unclosed DOCTYPE")}else throw Error("Invalid Tag instead of DOCTYPE");return{entities:r,i:t}}readEntityExp(e,t){t=R(e,t);let r="";for(;t<e.length&&!/\s/.test(e[t])&&'"'!==e[t]&&"'"!==e[t];)r+=e[t],t++;if(M(r),t=R(e,t),!this.suppressValidationErr){if("SYSTEM"===e.substring(t,t+6).toUpperCase())throw Error("External entities are not supported");else if("%"===e[t])throw Error("Parameter entities are not supported")}let i="";return[t,i]=this.readIdentifierVal(e,t,"entity"),[r,i,--t]}readNotationExp(e,t){t=R(e,t);let r="";for(;t<e.length&&!/\s/.test(e[t]);)r+=e[t],t++;this.suppressValidationErr||M(r),t=R(e,t);let i=e.substring(t,t+6).toUpperCase();if(!this.suppressValidationErr&&"SYSTEM"!==i&&"PUBLIC"!==i)throw Error(`Expected SYSTEM or PUBLIC, found "${i}"`);t+=i.length,t=R(e,t);let n=null,a=null;if("PUBLIC"===i)[t,n]=this.readIdentifierVal(e,t,"publicIdentifier"),t=R(e,t),('"'===e[t]||"'"===e[t])&&([t,a]=this.readIdentifierVal(e,t,"systemIdentifier"));else if("SYSTEM"===i&&([t,a]=this.readIdentifierVal(e,t,"systemIdentifier"),!this.suppressValidationErr&&!a))throw Error("Missing mandatory system identifier for SYSTEM notation");return{notationName:r,publicIdentifier:n,systemIdentifier:a,index:--t}}readIdentifierVal(e,t,r){let i="",n=e[t];if('"'!==n&&"'"!==n)throw Error(`Expected quoted string, found "${n}"`);for(t++;t<e.length&&e[t]!==n;)i+=e[t],t++;if(e[t]!==n)throw Error(`Unterminated ${r} value`);return[++t,i]}readElementExp(e,t){t=R(e,t);let r="";for(;t<e.length&&!/\s/.test(e[t]);)r+=e[t],t++;if(!this.suppressValidationErr&&!C(r))throw Error(`Invalid element name: "${r}"`);t=R(e,t);let i="";if("E"===e[t]&&_(e,"MPTY",t))t+=4;else if("A"===e[t]&&_(e,"NY",t))t+=2;else if("("===e[t]){for(t++;t<e.length&&")"!==e[t];)i+=e[t],t++;if(")"!==e[t])throw Error("Unterminated content model")}else if(!this.suppressValidationErr)throw Error(`Invalid Element Expression, found "${e[t]}"`);return{elementName:r,contentModel:i.trim(),index:t}}readAttlistExp(e,t){t=R(e,t);let r="";for(;t<e.length&&!/\s/.test(e[t]);)r+=e[t],t++;M(r),t=R(e,t);let i="";for(;t<e.length&&!/\s/.test(e[t]);)i+=e[t],t++;if(!M(i))throw Error(`Invalid attribute name: "${i}"`);t=R(e,t);let n="";if("NOTATION"===e.substring(t,t+8).toUpperCase()){if(n="NOTATION",t+=8,t=R(e,t),"("!==e[t])throw Error(`Expected '(', found "${e[t]}"`);t++;let r=[];for(;t<e.length&&")"!==e[t];){let i="";for(;t<e.length&&"|"!==e[t]&&")"!==e[t];)i+=e[t],t++;if(!M(i=i.trim()))throw Error(`Invalid notation name: "${i}"`);r.push(i),"|"===e[t]&&(t=R(e,++t))}if(")"!==e[t])throw Error("Unterminated list of notations");t++,n+=" ("+r.join("|")+")"}else{for(;t<e.length&&!/\s/.test(e[t]);)n+=e[t],t++;if(!this.suppressValidationErr&&!["CDATA","ID","IDREF","IDREFS","ENTITY","ENTITIES","NMTOKEN","NMTOKENS"].includes(n.toUpperCase()))throw Error(`Invalid attribute type: "${n}"`)}t=R(e,t);let a="";return"#REQUIRED"===e.substring(t,t+8).toUpperCase()?(a="#REQUIRED",t+=8):"#IMPLIED"===e.substring(t,t+7).toUpperCase()?(a="#IMPLIED",t+=7):[t,a]=this.readIdentifierVal(e,t,"ATTLIST"),{elementName:r,attributeName:i,attributeType:n,defaultValue:a,index:t}}}let R=(e,t)=>{for(;t<e.length&&/\s/.test(e[t]);)t++;return t};function _(e,t,r){for(let i=0;i<t.length;i++)if(t[i]!==e[r+i+1])return!1;return!0}function M(e){if(C(e))return e;throw Error(`Invalid entity name ${e}`)}let O=/^[-+]?0x[a-fA-F0-9]+$/,P=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,D={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0},k=/^([-+])?(0*)(\d*(\.\d*)?[eE][-\+]?\d+)$/;class ${constructor(e){if(this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(e,t)=>String.fromCodePoint(Number.parseInt(t,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(e,t)=>String.fromCodePoint(Number.parseInt(t,16))}},this.addExternalEntities=F,this.parseXml=L,this.parseTextData=V,this.resolveNameSpace=U,this.buildAttributesMap=j,this.isItStopNode=K,this.replaceEntitiesValue=X,this.readStopNodeData=W,this.saveTextToParentTag=q,this.addChild=B,this.ignoreAttributesFn=function(e){return"function"==typeof e?e:Array.isArray(e)?t=>{for(let r of e)if("string"==typeof r&&t===r||r instanceof RegExp&&r.test(t))return!0}:()=>!1}(this.options.ignoreAttributes),this.options.stopNodes&&this.options.stopNodes.length>0){this.stopNodesExact=new Set,this.stopNodesWildcard=new Set;for(let e=0;e<this.options.stopNodes.length;e++){const t=this.options.stopNodes[e];"string"==typeof t&&(t.startsWith("*.")?this.stopNodesWildcard.add(t.substring(2)):this.stopNodesExact.add(t))}}}}function F(e){let t=Object.keys(e);for(let r=0;r<t.length;r++){let i=t[r];this.lastEntities[i]={regex:RegExp("&"+i+";","g"),val:e[i]}}}function V(e,t,r,i,n,a,s){if(void 0!==e&&(this.options.trimValues&&!i&&(e=e.trim()),e.length>0)){s||(e=this.replaceEntitiesValue(e));let i=this.options.tagValueProcessor(t,e,r,n,a);return null==i?e:typeof i!=typeof e||i!==e?i:this.options.trimValues||e.trim()===e?Z(e,this.options.parseTagValue,this.options.numberParseOptions):e}}function U(e){if(this.options.removeNSPrefix){let t=e.split(":"),r="/"===e.charAt(0)?"/":"";if("xmlns"===t[0])return"";2===t.length&&(e=r+t[1])}return e}let H=RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");function j(e,t){if(!0!==this.options.ignoreAttributes&&"string"==typeof e){let r=I(e,H),i=r.length,n={};for(let e=0;e<i;e++){let i=this.resolveNameSpace(r[e][1]);if(this.ignoreAttributesFn(i,t))continue;let a=r[e][4],s=this.options.attributeNamePrefix+i;if(i.length)if(this.options.transformAttributeName&&(s=this.options.transformAttributeName(s)),"__proto__"===s&&(s="#__proto__"),void 0!==a){this.options.trimValues&&(a=a.trim()),a=this.replaceEntitiesValue(a);let e=this.options.attributeValueProcessor(i,a,t);null==e?n[s]=a:typeof e!=typeof a||e!==a?n[s]=e:n[s]=Z(a,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(n[s]=!0)}if(Object.keys(n).length){if(this.options.attributesGroupName){let e={};return e[this.options.attributesGroupName]=n,e}return n}}}let L=function(e){e=e.replace(/\r\n?/g,"\n");let t=new S("!xml"),r=t,i="",n="",a=new A(this.options.processEntities);for(let s=0;s<e.length;s++)if("<"===e[s])if("/"===e[s+1]){let t=Y(e,">",s,"Closing Tag is not closed."),a=e.substring(s+2,t).trim();if(this.options.removeNSPrefix){let e=a.indexOf(":");-1!==e&&(a=a.substr(e+1))}this.options.transformTagName&&(a=this.options.transformTagName(a)),r&&(i=this.saveTextToParentTag(i,r,n));let o=n.substring(n.lastIndexOf(".")+1);if(a&&-1!==this.options.unpairedTags.indexOf(a))throw Error(`Unpaired tag can not be used as closing tag: </${a}>`);let l=0;o&&-1!==this.options.unpairedTags.indexOf(o)?(l=n.lastIndexOf(".",n.lastIndexOf(".")-1),this.tagsNodeStack.pop()):l=n.lastIndexOf("."),n=n.substring(0,l),r=this.tagsNodeStack.pop(),i="",s=t}else if("?"===e[s+1]){let t=G(e,s,!1,"?>");if(!t)throw Error("Pi Tag is not closed.");if(i=this.saveTextToParentTag(i,r,n),this.options.ignoreDeclaration&&"?xml"===t.tagName||this.options.ignorePiTags);else{let e=new S(t.tagName);e.add(this.options.textNodeName,""),t.tagName!==t.tagExp&&t.attrExpPresent&&(e[":@"]=this.buildAttributesMap(t.tagExp,n)),this.addChild(r,e,n,s)}s=t.closeIndex+1}else if("!--"===e.substr(s+1,3)){let t=Y(e,"-->",s+4,"Comment is not closed.");if(this.options.commentPropName){let a=e.substring(s+4,t-2);i=this.saveTextToParentTag(i,r,n),r.add(this.options.commentPropName,[{[this.options.textNodeName]:a}])}s=t}else if("!D"===e.substr(s+1,2)){let t=a.readDocType(e,s);this.docTypeEntities=t.entities,s=t.i}else if("!["===e.substr(s+1,2)){let t=Y(e,"]]>",s,"CDATA is not closed.")-2,a=e.substring(s+9,t);i=this.saveTextToParentTag(i,r,n);let o=this.parseTextData(a,r.tagname,n,!0,!1,!0,!0);void 0==o&&(o=""),this.options.cdataPropName?r.add(this.options.cdataPropName,[{[this.options.textNodeName]:a}]):r.add(this.options.textNodeName,o),s=t+2}else{let a=G(e,s,this.options.removeNSPrefix),o=a.tagName,l=a.rawTagName,d=a.tagExp,u=a.attrExpPresent,p=a.closeIndex;if(this.options.transformTagName){let e=this.options.transformTagName(o);d===o&&(d=e),o=e}r&&i&&"!xml"!==r.tagname&&(i=this.saveTextToParentTag(i,r,n,!1));let c=r;c&&-1!==this.options.unpairedTags.indexOf(c.tagname)&&(r=this.tagsNodeStack.pop(),n=n.substring(0,n.lastIndexOf("."))),o!==t.tagname&&(n+=n?"."+o:o);let g=s;if(this.isItStopNode(this.stopNodesExact,this.stopNodesWildcard,n,o)){let t="";if(d.length>0&&d.lastIndexOf("/")===d.length-1)"/"===o[o.length-1]?(o=o.substr(0,o.length-1),n=n.substr(0,n.length-1),d=o):d=d.substr(0,d.length-1),s=a.closeIndex;else if(-1!==this.options.unpairedTags.indexOf(o))s=a.closeIndex;else{let r=this.readStopNodeData(e,l,p+1);if(!r)throw Error(`Unexpected end of ${l}`);s=r.i,t=r.tagContent}let i=new S(o);o!==d&&u&&(i[":@"]=this.buildAttributesMap(d,n)),t&&(t=this.parseTextData(t,o,n,!0,u,!0,!0)),n=n.substr(0,n.lastIndexOf(".")),i.add(this.options.textNodeName,t),this.addChild(r,i,n,g)}else{if(d.length>0&&d.lastIndexOf("/")===d.length-1){if("/"===o[o.length-1]?(o=o.substr(0,o.length-1),n=n.substr(0,n.length-1),d=o):d=d.substr(0,d.length-1),this.options.transformTagName){let e=this.options.transformTagName(o);d===o&&(d=e),o=e}let e=new S(o);o!==d&&u&&(e[":@"]=this.buildAttributesMap(d,n)),this.addChild(r,e,n,g),n=n.substr(0,n.lastIndexOf("."))}else{let e=new S(o);this.tagsNodeStack.push(r),o!==d&&u&&(e[":@"]=this.buildAttributesMap(d,n)),this.addChild(r,e,n,g),r=e}i="",s=p}}else i+=e[s];return t.child};function B(e,t,r,i){this.options.captureMetaData||(i=void 0);let n=this.options.updateTag(t.tagname,r,t[":@"]);!1===n||("string"==typeof n&&(t.tagname=n),e.addChild(t,i))}let X=function(e){if(this.options.processEntities){for(let t in this.docTypeEntities){let r=this.docTypeEntities[t];e=e.replace(r.regx,r.val)}for(let t in this.lastEntities){let r=this.lastEntities[t];e=e.replace(r.regex,r.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){let r=this.htmlEntities[t];e=e.replace(r.regex,r.val)}e=e.replace(this.ampEntity.regex,this.ampEntity.val)}return e};function q(e,t,r,i){return e&&(void 0===i&&(i=0===t.child.length),void 0!==(e=this.parseTextData(e,t.tagname,r,!1,!!t[":@"]&&0!==Object.keys(t[":@"]).length,i))&&""!==e&&t.add(this.options.textNodeName,e),e=""),e}function K(e,t,r,i){return!!(t&&t.has(i)||e&&e.has(r))}function Y(e,t,r,i){let n=e.indexOf(t,r);if(-1!==n)return n+t.length-1;throw Error(i)}function G(e,t,r,i=">"){let n=function(e,t,r=">"){let i,n="";for(let a=t;a<e.length;a++){let t=e[a];if(i)t===i&&(i="");else if('"'===t||"'"===t)i=t;else if(t===r[0]){if(!r[1])return{data:n,index:a};else if(e[a+1]===r[1])return{data:n,index:a}}else"	"===t&&(t=" ");n+=t}}(e,t+1,i);if(!n)return;let a=n.data,s=n.index,o=a.search(/\s/),l=a,d=!0;-1!==o&&(l=a.substring(0,o),a=a.substring(o+1).trimStart());let u=l;if(r){let e=l.indexOf(":");-1!==e&&(d=(l=l.substr(e+1))!==n.data.substr(e+1))}return{tagName:l,tagExp:a,closeIndex:s,attrExpPresent:d,rawTagName:u}}function W(e,t,r){let i=r,n=1;for(;r<e.length;r++)if("<"===e[r])if("/"===e[r+1]){let a=Y(e,">",r,`${t} is not closed`);if(e.substring(r+2,a).trim()===t&&0==--n)return{tagContent:e.substring(i,r),i:a};r=a}else if("?"===e[r+1])r=Y(e,"?>",r+1,"StopNode is not closed.");else if("!--"===e.substr(r+1,3))r=Y(e,"-->",r+3,"StopNode is not closed.");else if("!["===e.substr(r+1,2))r=Y(e,"]]>",r,"StopNode is not closed.")-2;else{let i=G(e,r,">");i&&((i&&i.tagName)===t&&"/"!==i.tagExp[i.tagExp.length-1]&&n++,r=i.closeIndex)}}function Z(e,t,r){if(t&&"string"==typeof e){let t=e.trim();return"true"===t||"false"!==t&&function(e,t={}){if(t=Object.assign({},D,t),!e||"string"!=typeof e)return e;let r=e.trim();if(void 0!==t.skipLike&&t.skipLike.test(r))return e;{if("0"===e)return 0;if(t.hex&&O.test(r)){var i,n=r;if(parseInt)return parseInt(n,16);if(Number.parseInt)return Number.parseInt(n,16);if(window&&window.parseInt)return window.parseInt(n,16);throw Error("parseInt, Number.parseInt, window.parseInt are not supported")}if(r.includes("e")||r.includes("E"))return function(e,t,r){if(!r.eNotation)return e;let i=t.match(k);if(!i)return e;{let n=i[1]||"",a=-1===i[3].indexOf("e")?"E":"e",s=i[2],o=n?e[s.length+1]===a:e[s.length]===a;return s.length>1&&o?e:1===s.length&&(i[3].startsWith(`.${a}`)||i[3][0]===a)?Number(t):r.leadingZeros&&!o?Number(t=(i[1]||"")+i[3]):e}}(e,r,t);let a=P.exec(r);if(!a)return e;{let n=a[1]||"",s=a[2],o=((i=a[3])&&-1!==i.indexOf(".")&&("."===(i=i.replace(/0+$/,""))?i="0":"."===i[0]?i="0"+i:"."===i[i.length-1]&&(i=i.substring(0,i.length-1))),i),l=n?"."===e[s.length+1]:"."===e[s.length];if(!t.leadingZeros&&(s.length>1||1===s.length&&!l))return e;{let i=Number(r),a=String(i);if(0===i)return i;if(-1!==a.search(/[eE]/))if(t.eNotation)return i;else return e;if(-1!==r.indexOf("."))if("0"===a)return i;else if(a===o)return i;else if(a===`${n}${o}`)return i;else return e;let l=s?o:r;return s?l===a||n+l===a?i:e:l===a||l===n+a?i:e}}}}(e,r)}return void 0!==e?e:""}let z=S.getMetaDataSymbol(),Q={allowBooleanAttributes:!1,unpairedTags:[]};function J(e){return" "===e||"	"===e||"\n"===e||"\r"===e}function ee(e,t){let r=t;for(;t<e.length;t++)if("?"==e[t]||" "==e[t]){let i=e.substr(r,t-r);if(t>5&&"xml"===i)return en("InvalidXml","XML declaration allowed only at the start of the document.",ea(e,t));if("?"!=e[t]||">"!=e[t+1])continue;t++;break}return t}function et(e,t){if(e.length>t+5&&"-"===e[t+1]&&"-"===e[t+2]){for(t+=3;t<e.length;t++)if("-"===e[t]&&"-"===e[t+1]&&">"===e[t+2]){t+=2;break}}else if(e.length>t+8&&"D"===e[t+1]&&"O"===e[t+2]&&"C"===e[t+3]&&"T"===e[t+4]&&"Y"===e[t+5]&&"P"===e[t+6]&&"E"===e[t+7]){let r=1;for(t+=8;t<e.length;t++)if("<"===e[t])r++;else if(">"===e[t]&&0==--r)break}else if(e.length>t+9&&"["===e[t+1]&&"C"===e[t+2]&&"D"===e[t+3]&&"A"===e[t+4]&&"T"===e[t+5]&&"A"===e[t+6]&&"["===e[t+7]){for(t+=8;t<e.length;t++)if("]"===e[t]&&"]"===e[t+1]&&">"===e[t+2]){t+=2;break}}return t}let er=RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function ei(e,t){let r=I(e,er),i={};for(let e=0;e<r.length;e++){if(0===r[e][1].length)return en("InvalidAttr","Attribute '"+r[e][2]+"' has no space in starting.",es(r[e]));if(void 0!==r[e][3]&&void 0===r[e][4])return en("InvalidAttr","Attribute '"+r[e][2]+"' is without value.",es(r[e]));if(void 0===r[e][3]&&!t.allowBooleanAttributes)return en("InvalidAttr","boolean attribute '"+r[e][2]+"' is not allowed.",es(r[e]));let n=r[e][2];if(!C(n))return en("InvalidAttr","Attribute '"+n+"' is an invalid name.",es(r[e]));if(i.hasOwnProperty(n))return en("InvalidAttr","Attribute '"+n+"' is repeated.",es(r[e]));i[n]=1}return!0}function en(e,t,r){return{err:{code:e,msg:t,line:r.line||r,col:r.col}}}function ea(e,t){let r=e.substring(0,t).split(/\r?\n/);return{line:r.length,col:r[r.length-1].length+1}}function es(e){return e.startIndex+e[1].length}class eo{constructor(e){this.externalEntities={},this.options=Object.assign({},T,e)}parse(e,t){if("string"!=typeof e&&e.toString)e=e.toString();else if("string"!=typeof e)throw Error("XML data is accepted in String or Bytes[] form.");if(t){!0===t&&(t={});let r=function(e,t){t=Object.assign({},Q,t);let r=[],i=!1,n=!1;"\uFEFF"===e[0]&&(e=e.substr(1));for(let a=0;a<e.length;a++)if("<"===e[a]&&"?"===e[a+1]){if(a+=2,(a=ee(e,a)).err)return a}else if("<"===e[a]){let s=a;if("!"===e[++a]){a=et(e,a);continue}{let o=!1;"/"===e[a]&&(o=!0,a++);let l="";for(;a<e.length&&">"!==e[a]&&" "!==e[a]&&"	"!==e[a]&&"\n"!==e[a]&&"\r"!==e[a];a++)l+=e[a];if("/"===(l=l.trim())[l.length-1]&&(l=l.substring(0,l.length-1),a--),!C(l))return en("InvalidTag",0===l.trim().length?"Invalid space after '<'.":"Tag '"+l+"' is an invalid name.",ea(e,a));let d=function(e,t){let r="",i="",n=!1;for(;t<e.length;t++){if('"'===e[t]||"'"===e[t])""===i?i=e[t]:i!==e[t]||(i="");else if(">"===e[t]&&""===i){n=!0;break}r+=e[t]}return""===i&&{value:r,index:t,tagClosed:n}}(e,a);if(!1===d)return en("InvalidAttr","Attributes for '"+l+"' have open quote.",ea(e,a));let u=d.value;if(a=d.index,"/"===u[u.length-1]){let r=a-u.length,n=ei(u=u.substring(0,u.length-1),t);if(!0!==n)return en(n.err.code,n.err.msg,ea(e,r+n.err.line));i=!0}else if(o)if(!d.tagClosed)return en("InvalidTag","Closing tag '"+l+"' doesn't have proper closing.",ea(e,a));else{if(u.trim().length>0)return en("InvalidTag","Closing tag '"+l+"' can't have attributes or invalid starting.",ea(e,s));if(0===r.length)return en("InvalidTag","Closing tag '"+l+"' has not been opened.",ea(e,s));let t=r.pop();if(l!==t.tagName){let r=ea(e,t.tagStartPos);return en("InvalidTag","Expected closing tag '"+t.tagName+"' (opened in line "+r.line+", col "+r.col+") instead of closing tag '"+l+"'.",ea(e,s))}0==r.length&&(n=!0)}else{let o=ei(u,t);if(!0!==o)return en(o.err.code,o.err.msg,ea(e,a-u.length+o.err.line));if(!0===n)return en("InvalidXml","Multiple possible root nodes found.",ea(e,a));-1!==t.unpairedTags.indexOf(l)||r.push({tagName:l,tagStartPos:s}),i=!0}for(a++;a<e.length;a++)if("<"===e[a])if("!"===e[a+1]){a=et(e,++a);continue}else if("?"===e[a+1]){if((a=ee(e,++a)).err)return a}else break;else if("&"===e[a]){let t=function(e,t){if(";"===e[++t])return -1;if("#"===e[t]){var r=++t;let i=/\d/;for("x"===e[r]&&(r++,i=/[\da-fA-F]/);r<e.length;r++){if(";"===e[r])return r;if(!e[r].match(i))break}return -1}let i=0;for(;t<e.length;t++,i++)if(!e[t].match(/\w/)||!(i<20)){if(";"===e[t])break;return -1}return t}(e,a);if(-1==t)return en("InvalidChar","char '&' is not expected.",ea(e,a));a=t}else if(!0===n&&!J(e[a]))return en("InvalidXml","Extra text at the end",ea(e,a));"<"===e[a]&&a--}}else{if(J(e[a]))continue;return en("InvalidChar","char '"+e[a]+"' is not expected.",ea(e,a))}return i?1==r.length?en("InvalidTag","Unclosed tag '"+r[0].tagName+"'.",ea(e,r[0].tagStartPos)):!(r.length>0)||en("InvalidXml","Invalid '"+JSON.stringify(r.map(e=>e.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1}):en("InvalidXml","Start tag expected.",1)}(e,t);if(!0!==r)throw Error(`${r.err.msg}:${r.err.line}:${r.err.col}`)}let r=new $(this.options);r.addExternalEntities(this.externalEntities);let i=r.parseXml(e);return this.options.preserveOrder||void 0===i?i:function e(t,r,i){let n,a={};for(let s=0;s<t.length;s++){let o=t[s],l=function(e){let t=Object.keys(e);for(let e=0;e<t.length;e++){let r=t[e];if(":@"!==r)return r}}(o),d="";if(d=void 0===i?l:i+"."+l,l===r.textNodeName)void 0===n?n=o[l]:n+=""+o[l];else if(void 0===l)continue;else if(o[l]){let t=e(o[l],r,d),i=function(e,t){let{textNodeName:r}=t,i=Object.keys(e).length;return 0===i||1===i&&(!!e[r]||"boolean"==typeof e[r]||0===e[r])}(t,r);void 0!==o[z]&&(t[z]=o[z]),o[":@"]?function(e,t,r,i){if(t){let n=Object.keys(t),a=n.length;for(let s=0;s<a;s++){let a=n[s];i.isArray(a,r+"."+a,!0,!0)?e[a]=[t[a]]:e[a]=t[a]}}}(t,o[":@"],d,r):1!==Object.keys(t).length||void 0===t[r.textNodeName]||r.alwaysCreateTextNode?0===Object.keys(t).length&&(r.alwaysCreateTextNode?t[r.textNodeName]="":t=""):t=t[r.textNodeName],void 0!==a[l]&&a.hasOwnProperty(l)?(Array.isArray(a[l])||(a[l]=[a[l]]),a[l].push(t)):r.isArray(l,d,i)?a[l]=[t]:a[l]=t}}return"string"==typeof n?n.length>0&&(a[r.textNodeName]=n):void 0!==n&&(a[r.textNodeName]=n),a}(i,this.options)}addEntity(e,t){if(-1!==t.indexOf("&"))throw Error("Entity value can't have '&'");if(-1!==e.indexOf("&")||-1!==e.indexOf(";"))throw Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if("&"===t)throw Error("An entity with value '&' is not permitted");this.externalEntities[e]=t}static getMetaDataSymbol(){return S.getMetaDataSymbol()}}function el(e){return e?Array.isArray(e)?e:[e]:[]}function ed(e,t){let r=t.split("."),i=e;for(let e of r){if(null==i||"object"!=typeof i)return;i=i[e]}return i}function eu(e){let t={startTime:e["@_StartTime"]||"",totalTimeSeconds:Number(e.TotalTimeSeconds)||0,distanceMeters:Number(e.DistanceMeters)||0,calories:Number(e.Calories)||0};void 0!==e.MaximumSpeed&&(t.maximumSpeed=Number(e.MaximumSpeed));let r=ed(e,"AverageHeartRateBpm.Value");void 0!==r&&(t.averageHeartRateBpm=Number(r));let i=ed(e,"MaximumHeartRateBpm.Value");void 0!==i&&(t.maximumHeartRateBpm=Number(i)),e.Intensity&&(t.intensity=String(e.Intensity)),void 0!==e.Cadence&&(t.cadence=Number(e.Cadence));let n=e.Extensions;if(n&&!t.cadence){let e=n.LX;e?.AvgRunCadence!==void 0&&(t.cadence=Number(e.AvgRunCadence));let r=n["ns3:LX"];r?.AvgRunCadence!==void 0&&(t.cadence=Number(r.AvgRunCadence))}return e.TriggerMethod&&(t.triggerMethod=String(e.TriggerMethod)),t}function ep(e){let t,r,i=e["@_Sport"]||"Other",n=e.Id||"",a=el(e.Lap),s=a.map(eu),o=[];for(let e of a)for(let t of el(e.Track))for(let e of el(t.Trackpoint))o.push(function(e){let t={time:String(e.Time||"")},r=e.Position;r&&(void 0!==r.LatitudeDegrees&&(t.latitude=Number(r.LatitudeDegrees)),void 0!==r.LongitudeDegrees&&(t.longitude=Number(r.LongitudeDegrees))),void 0!==e.AltitudeMeters&&(t.altitudeMeters=Number(e.AltitudeMeters)),void 0!==e.DistanceMeters&&(t.distanceMeters=Number(e.DistanceMeters));let i=ed(e,"HeartRateBpm.Value");void 0!==i&&(t.heartRateBpm=Number(i)),void 0!==e.Cadence&&(t.cadence=Number(e.Cadence));let n=e.Extensions;if(n){let e=n.TPX;e?.Speed!==void 0&&(t.speed=Number(e.Speed)),t.cadence||e?.RunCadence===void 0||(t.cadence=Number(e.RunCadence));let r=n["ns3:TPX"];r?.Speed!==void 0&&(t.speed=Number(r.Speed)),t.cadence||r?.RunCadence===void 0||(t.cadence=Number(r.RunCadence))}return t}(e));let l=s.reduce((e,t)=>e+t.totalTimeSeconds,0),d=s.reduce((e,t)=>e+t.distanceMeters,0),u=s.reduce((e,t)=>e+t.calories,0),p=s.filter(e=>void 0!==e.averageHeartRateBpm),c=p.length>0?Math.round(p.reduce((e,t)=>e+(t.averageHeartRateBpm||0),0)/p.length):void 0,g=s.map(e=>e.maximumHeartRateBpm).filter(e=>void 0!==e),h=g.length>0?Math.max(...g):void 0,f=s.filter(e=>void 0!==e.cadence),m=f.length>0?Math.round(f.reduce((e,t)=>e+(t.cadence||0),0)/f.length):void 0,v=l>0?d/l:0,x=v>0?Math.round(1e3/v):void 0,E=o.filter(e=>void 0!==e.speed&&e.speed>0);if(E.length>0){let e=Math.max(...E.map(e=>e.speed));t=e>0?Math.round(1e3/e):void 0}let b=function(e){let t=0,r=0,i=null;for(let n of e)if(void 0!==n.altitudeMeters){if(null!==i){let e=n.altitudeMeters-i;e>0?t+=e:r+=Math.abs(e)}i=n.altitudeMeters}return{gain:t,loss:r}}(o),N=e.Creator,T=N?.Name?String(N.Name):void 0,w=new Date(n);return{sport:"running"===(r=i.toLowerCase())||"run"===r?"run":"biking"===r||"cycling"===r||"bike"===r?"cycling":"swimming"===r||"swim"===r?"swimming":"walking"===r||"walk"===r?"walk":r.includes("cross")||r.includes("training")?"cross_training":"other",id:n,startTime:w,totalTimeSeconds:l,distanceMeters:d,calories:u,averageHeartRateBpm:c,maximumHeartRateBpm:h,averageCadence:m,averageSpeed:v,averagePaceSecPerKm:x,bestPaceSecPerKm:t,elevationGainMeters:b.gain>0?b.gain:void 0,elevationLossMeters:b.loss>0?b.loss:void 0,laps:s,trackpoints:o,deviceName:T}}var ec=e.i(99646);async function eg(e){try{let r,i=await (0,N.createClient)(),{data:{user:n}}=await i.auth.getUser();if(!n)return b.NextResponse.json({error:"Niet ingelogd"},{status:401});let a=(await e.formData()).get("file");if(!a)return b.NextResponse.json({error:"Geen bestand geüpload"},{status:400});if(!a.name.toLowerCase().endsWith(".tcx"))return b.NextResponse.json({error:"Ongeldig bestandstype. Alleen TCX bestanden worden ondersteund."},{status:400});let s=await a.text();try{r=function(e){let t,r=new eo({ignoreAttributes:!1,attributeNamePrefix:"@_",parseTagValue:!0,parseAttributeValue:!0,trimValues:!0});try{t=r.parse(e)}catch(e){throw Error(`Invalid TCX file: ${e instanceof Error?e.message:"Parsing failed"}`)}let i=t.TrainingCenterDatabase;if(!i)throw Error("Invalid TCX file: Missing TrainingCenterDatabase element");let n=i.Activities;if(!n)throw Error("Invalid TCX file: Missing Activities element");let a=el(n.Activity);if(0===a.length)throw Error("No activities found in TCX file");return{activities:a.map(ep)}}(s)}catch(e){return b.NextResponse.json({error:`Kon bestand niet lezen: ${e instanceof Error?e.message:"Onbekende fout"}`},{status:400})}if(0===r.activities.length)return b.NextResponse.json({error:"Geen activiteiten gevonden in het bestand"},{status:400});let o=[],l=[];for(let e of r.activities){var t;let r=`tcx_${e.id}`,{data:a}=await i.from("activities").select("id").eq("user_id",n.id).eq("external_id",r).single();if(a){l.push(`Activiteit van ${e.startTime.toLocaleDateString("nl-NL")} bestaat al`);continue}let s=function(e){let t=e.filter(e=>void 0!==e.latitude&&void 0!==e.longitude).map(e=>({lat:e.latitude,lon:e.longitude,ele:e.altitudeMeters,time:e.time,hr:e.heartRateBpm,cad:e.cadence}));return t.length>0?{track:t}:null}(e.trackpoints),d=(t=e.laps,0===t.length?null:{splits:t.map((e,t)=>({lapNumber:t+1,startTime:e.startTime,durationSeconds:e.totalTimeSeconds,distanceMeters:e.distanceMeters,paceSecPerKm:e.distanceMeters>0?Math.round(e.totalTimeSeconds/e.distanceMeters*1e3):null,avgHeartRate:e.averageHeartRateBpm,maxHeartRate:e.maximumHeartRateBpm,cadence:e.cadence,calories:e.calories}))}),u=new Date(e.startTime.getTime()+1e3*e.totalTimeSeconds),p={user_id:n.id,source:"import",external_id:r,activity_type:e.sport,title:function(e,t){let r=t/1e3,i={run:"Hardlopen",walk:"Wandelen",cycling:"Fietsen",swimming:"Zwemmen",cross_training:"Cross-training",other:"Training"}[e]||"Training";return r>=1?`${i} - ${r.toFixed(1)} km`:i}(e.sport,e.distanceMeters),started_at:e.startTime.toISOString(),finished_at:u.toISOString(),duration_seconds:Math.round(e.totalTimeSeconds),moving_time_seconds:Math.round(e.totalTimeSeconds),distance_meters:e.distanceMeters,avg_pace_sec_per_km:e.averagePaceSecPerKm,best_pace_sec_per_km:e.bestPaceSecPerKm,avg_heart_rate:e.averageHeartRateBpm,max_heart_rate:e.maximumHeartRateBpm,elevation_gain_meters:e.elevationGainMeters,elevation_loss_meters:e.elevationLossMeters,avg_cadence:e.averageCadence,calories:e.calories>0?e.calories:null,gpx_data:s,splits_data:d},{data:c,error:g}=await i.from("activities").insert(p).select().single();g?(console.error("Insert error:",g),l.push(`Fout bij opslaan van activiteit: ${g.message}`)):c&&o.push(c)}if(0===o.length&&l.length>0)return b.NextResponse.json({error:l[0]},{status:400});if(o.length>0){let e=o[0],t=e.distance_meters?(Number(e.distance_meters)/1e3).toFixed(1):null;await (0,ec.createNotification)({supabase:i,userId:n.id,type:"activity_uploaded",title:1===o.length?"Activiteit geüpload":`${o.length} activiteiten ge\xfcpload`,message:t?`${e.title||"Training"} - ${t} km`:e.title||"Training",data:{activity_id:e.id,count:o.length}})}return b.NextResponse.json({success:!0,message:`${o.length} activiteit${1!==o.length?"en":""} ge\xefmporteerd`,activities:o,errors:l.length>0?l:void 0})}catch(e){return console.error("Upload error:",e),b.NextResponse.json({error:"Er is een fout opgetreden bij het uploaden"},{status:500})}}e.s(["POST",()=>eg],94173);var eh=e.i(94173);let ef=new r.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/activities/upload/route",pathname:"/api/activities/upload",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/apps/web/src/app/api/activities/upload/route.ts",nextConfigOutput:"",userland:eh}),{workAsyncStorage:em,workUnitAsyncStorage:ev,serverHooks:ex}=ef;function eE(){return(0,n.patchFetch)({workAsyncStorage:em,workUnitAsyncStorage:ev})}async function eb(e,t,r){ef.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let n="/api/activities/upload/route";n=n.replace(/\/index$/,"")||"/";let b=await ef.prepare(e,t,{srcPage:n,multiZoneDraftMode:!1});if(!b)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:N,params:T,nextConfig:w,parsedUrl:y,isDraftMode:I,prerenderManifest:C,routerServerContext:S,isOnDemandRevalidate:A,revalidateOnlyGenerated:R,resolvedPathname:_,clientReferenceManifest:M,serverActionsManifest:O}=b,P=(0,d.normalizeAppPath)(n),D=!!(C.dynamicRoutes[P]||C.routes[_]),k=async()=>((null==S?void 0:S.render404)?await S.render404(e,t,y,!1):t.end("This page could not be found"),null);if(D&&!I){let e=!!C.routes[_],t=C.dynamicRoutes[P];if(t&&!1===t.fallback&&!e){if(w.experimental.adapterPath)return await k();throw new x.NoFallbackError}}let $=null;!D||ef.isDev||I||($="/index"===($=_)?"/":$);let F=!0===ef.isDev||!D,V=D&&!F;O&&M&&(0,o.setReferenceManifestsSingleton)({page:n,clientReferenceManifest:M,serverActionsManifest:O,serverModuleMap:(0,l.createServerModuleMap)({serverActionsManifest:O})});let U=e.method||"GET",H=(0,s.getTracer)(),j=H.getActiveScopeSpan(),L={params:T,prerenderManifest:C,renderOpts:{experimental:{authInterrupts:!!w.experimental.authInterrupts},cacheComponents:!!w.cacheComponents,supportsDynamicResponse:F,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:w.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,i)=>ef.onRequestError(e,t,i,S)},sharedContext:{buildId:N}},B=new u.NodeNextRequest(e),X=new u.NodeNextResponse(t),q=p.NextRequestAdapter.fromNodeNextRequest(B,(0,p.signalFromNodeResponse)(t));try{let o=async e=>ef.handle(q,L).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=H.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let i=r.get("next.route");if(i){let t=`${U} ${i}`;e.setAttributes({"next.route":i,"http.route":i,"next.span_name":t}),e.updateName(t)}else e.updateName(`${U} ${n}`)}),l=!!(0,a.getRequestMeta)(e,"minimalMode"),d=async a=>{var s,d;let u=async({previousCacheEntry:i})=>{try{if(!l&&A&&R&&!i)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await o(a);e.fetchMetrics=L.renderOpts.fetchMetrics;let s=L.renderOpts.pendingWaitUntil;s&&r.waitUntil&&(r.waitUntil(s),s=void 0);let d=L.renderOpts.collectedTags;if(!D)return await (0,h.sendResponse)(B,X,n,L.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,f.toNodeOutgoingHttpHeaders)(n.headers);d&&(t[v.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==L.renderOpts.collectedRevalidate&&!(L.renderOpts.collectedRevalidate>=v.INFINITE_CACHE)&&L.renderOpts.collectedRevalidate,i=void 0===L.renderOpts.collectedExpire||L.renderOpts.collectedExpire>=v.INFINITE_CACHE?void 0:L.renderOpts.collectedExpire;return{value:{kind:E.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:i}}}}catch(t){throw(null==i?void 0:i.isStale)&&await ef.onRequestError(e,t,{routerKind:"App Router",routePath:n,routeType:"route",revalidateReason:(0,g.getRevalidateReason)({isStaticGeneration:V,isOnDemandRevalidate:A})},S),t}},p=await ef.handleResponse({req:e,nextConfig:w,cacheKey:$,routeKind:i.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:C,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:R,responseGenerator:u,waitUntil:r.waitUntil,isMinimalMode:l});if(!D)return null;if((null==p||null==(s=p.value)?void 0:s.kind)!==E.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==p||null==(d=p.value)?void 0:d.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});l||t.setHeader("x-nextjs-cache",A?"REVALIDATED":p.isMiss?"MISS":p.isStale?"STALE":"HIT"),I&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let c=(0,f.fromNodeOutgoingHttpHeaders)(p.value.headers);return l&&D||c.delete(v.NEXT_CACHE_TAGS_HEADER),!p.cacheControl||t.getHeader("Cache-Control")||c.get("Cache-Control")||c.set("Cache-Control",(0,m.getCacheControlHeader)(p.cacheControl)),await (0,h.sendResponse)(B,X,new Response(p.value.body,{headers:c,status:p.value.status||200})),null};j?await d(j):await H.withPropagatedContext(e.headers,()=>H.trace(c.BaseServerSpan.handleRequest,{spanName:`${U} ${n}`,kind:s.SpanKind.SERVER,attributes:{"http.method":U,"http.target":e.url}},d))}catch(t){if(t instanceof x.NoFallbackError||await ef.onRequestError(e,t,{routerKind:"App Router",routePath:P,routeType:"route",revalidateReason:(0,g.getRevalidateReason)({isStaticGeneration:V,isOnDemandRevalidate:A})}),D)throw t;return await (0,h.sendResponse)(B,X,new Response(null,{status:500})),null}}e.s(["handler",()=>eb,"patchFetch",()=>eE,"routeModule",()=>ef,"serverHooks",()=>ex,"workAsyncStorage",()=>em,"workUnitAsyncStorage",()=>ev],44970)}];

//# sourceMappingURL=0b804_next_dist_esm_build_templates_app-route_5eb23db0.js.map